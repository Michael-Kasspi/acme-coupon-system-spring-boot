function _classCallCheck(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}function _createClass(n,e,t){return e&&_defineProperties(n.prototype,e),t&&_defineProperties(n,t),n}(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"4zr2":function(n,e,t){"use strict";t.d(e,"a",(function(){return s}));var o=t("3WY7"),a=t("lJxs"),i=t("1aa5"),r=t("ODr4"),u=t("8Y7J"),l=t("IheW"),c=t("rnfj"),s=function(){var n=function(){function n(e,t){_classCallCheck(this,n),this.client=e,this.endpoint=t}return _createClass(n,[{key:"getCompany",value:function(){return this.client.get("".concat(this.endpoint.url,"company/"),{withCredentials:!0}).pipe(Object(a.a)((function(n){return new o.a(n)})))}},{key:"getCoupons",value:function(){return this.client.get("".concat(this.endpoint.url,"company/coupons/"),{withCredentials:!0}).pipe(Object(a.a)((function(n){return n.map((function(n){return new i.a(n)}))})))}},{key:"deleteCoupon",value:function(n){if(!n)throw new Error("Unable to delete coupon without id");return this.client.delete("".concat(this.endpoint.url,"company/coupons/").concat(n),{withCredentials:!0})}},{key:"getCoupon",value:function(n){if(!n)throw new Error("Unable to get coupon without id");return this.client.get("".concat(this.endpoint.url,"company/coupons/").concat(n),{withCredentials:!0}).pipe(Object(a.a)((function(n){return new i.a(n)})))}},{key:"getAllCategories",value:function(){return this.client.get("".concat(this.endpoint.url,"company/coupons/categories"),{withCredentials:!0}).pipe(Object(a.a)((function(n){return n.map((function(n){return new r.a(n)}))})))}},{key:"addCoupon",value:function(n){if(!n)throw new Error("Unable to add coupon without coupon");return this.client.post("".concat(this.endpoint.url,"company/coupons/"),n.serialize(),{withCredentials:!0}).pipe(Object(a.a)((function(n){return new i.a(n)})))}},{key:"updateCoupon",value:function(n){if(!n)throw new Error("Unable to add coupon without coupon");return this.client.put("".concat(this.endpoint.url,"company/coupons/"),n.serialize(),{withCredentials:!0}).pipe(Object(a.a)((function(n){return new i.a(n)})))}},{key:"uploadCouponImage",value:function(n,e){if(!e)throw new Error("Unable to upload coupon image without image");var t=new FormData;return t.append("image",e),this.client.post("".concat(this.endpoint.url,"company/coupons/").concat(n,"/images"),t,{withCredentials:!0,reportProgress:!0,observe:"events"})}},{key:"deleteCouponImage",value:function(n){if(!n)throw new Error("Unable to delete coupon image without id");return this.client.delete("".concat(this.endpoint.url,"company/coupons/").concat(n,"/images"),{withCredentials:!0}).pipe(Object(a.a)((function(n){return new i.a(n)})))}},{key:"updateCompany",value:function(n){if(!n)throw new Error("Unable to update company without company");return this.client.put("".concat(this.endpoint.url,"company/"),n.serialize,{withCredentials:!0}).pipe(Object(a.a)((function(n){return new o.a(n)})))}},{key:"uploadCompanyLogo",value:function(n){if(!n)throw new Error("Unable to upload company logo without image");var e=new FormData;return e.append("image",n),this.client.post("".concat(this.endpoint.url,"company/logo/"),e,{withCredentials:!0,reportProgress:!0,observe:"events"})}},{key:"deleteCompanyLogo",value:function(){return this.client.delete("".concat(this.endpoint.url,"company/logo/"),{withCredentials:!0}).pipe(Object(a.a)((function(n){return new o.a(n)})))}}]),n}();return n.\u0275prov=u.cc({factory:function(){return new n(u.dc(l.c),u.dc(c.a))},token:n,providedIn:"root"}),n}()},"B/JR":function(n,e,t){"use strict";t.r(e);var o=t("8Y7J"),a=function n(){_classCallCheck(this,n)},i=t("pMnS"),r=t("M9ds"),u=t("SCoL"),l=t("UhP/"),c=t("YEUz"),s=t("omvX"),p=t("Pwwu"),d=t("9gLZ"),b=t("7KAL"),f=t("iInd"),h=t("SVse"),v=function(){function n(e){_classCallCheck(this,n),this.titleService=e}return _createClass(n,[{key:"ngOnInit",value:function(){this.titleService.append("Coupon Manager")}}]),n}(),g=t("Trmh"),y=o.xb({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;flex:1 0 auto}.company-manager-container[_ngcontent-%COMP%]{min-height:100%;box-sizing:border-box;width:100%;flex:1 0 auto;display:flex;flex-direction:column}.company-manager-content[_ngcontent-%COMP%]{flex:1 0 auto;min-height:100%;width:100%;display:flex}.company-nav-bar[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;z-index:1;background-color:#fff}.company-edit-coupon-link[_ngcontent-%COMP%]{display:none}"]],data:{}});function m(n){return o.bc(0,[(n()(),o.zb(0,0,null,null,2,"div",[["class","mat-tab-link mat-focus-indicator"],["mat-tab-link",""]],[[1,"aria-current",0],[1,"aria-disabled",0],[1,"tabIndex",0],[2,"mat-tab-disabled",null],[2,"mat-tab-label-active",null]],null,null,null,null)),o.yb(1,147456,[[1,4]],0,r.j,[r.k,o.l,o.A,u.a,[2,l.i],[8,null],c.h,[2,s.a]],{active:[0,"active"]},null),(n()(),o.Yb(-1,null,[" Edit Coupon "]))],(function(n,e){n(e,1,0,o.Ob(e.parent,20).isActive)}),(function(n,e){n(e,0,0,o.Ob(e,1).active?"page":null,o.Ob(e,1).disabled,o.Ob(e,1).tabIndex,o.Ob(e,1).disabled,o.Ob(e,1).active)}))}function k(n){return o.bc(0,[(n()(),o.zb(0,0,null,null,27,"div",[["class","company-manager-container"]],null,null,null,null,null)),(n()(),o.zb(1,0,null,null,23,"nav",[["class","company-nav-bar mat-tab-nav-bar mat-tab-header"],["color","primary"],["mat-tab-nav-bar",""]],[[2,"mat-tab-header-pagination-controls-enabled",null],[2,"mat-tab-header-rtl",null],[2,"mat-primary",null],[2,"mat-accent",null],[2,"mat-warn",null]],null,null,p.e,p.c)),o.yb(2,7520256,null,1,r.k,[o.l,[2,d.b],o.A,o.h,b.e,[2,u.a],[2,s.a]],{color:[0,"color"]},null),o.Ub(603979776,1,{_items:1}),(n()(),o.zb(4,0,null,0,6,"a",[["class","mat-tab-link mat-focus-indicator"],["mat-tab-link",""],["routerLink","./all"],["routerLinkActive",""]],[[1,"target",0],[8,"href",4],[1,"aria-current",0],[1,"aria-disabled",0],[1,"tabIndex",0],[2,"mat-tab-disabled",null],[2,"mat-tab-label-active",null]],[[null,"click"]],(function(n,e,t){var a=!0;return"click"===e&&(a=!1!==o.Ob(n,5).onClick(t.button,t.ctrlKey,t.metaKey,t.shiftKey)&&a),a}),null,null)),o.yb(5,671744,[[3,4]],0,f.r,[f.o,f.a,h.j],{routerLink:[0,"routerLink"]},null),o.yb(6,1720320,[["rla1",4]],2,f.q,[f.o,o.l,o.F,[2,f.p],[2,f.r]],{routerLinkActive:[0,"routerLinkActive"]},null),o.Ub(603979776,2,{links:1}),o.Ub(603979776,3,{linksWithHrefs:1}),o.yb(9,147456,[[1,4]],0,r.j,[r.k,o.l,o.A,u.a,[2,l.i],[8,null],c.h,[2,s.a]],{active:[0,"active"]},null),(n()(),o.Yb(-1,null,[" All Coupons "])),(n()(),o.zb(11,0,null,0,6,"a",[["class","mat-tab-link mat-focus-indicator"],["mat-tab-link",""],["routerLink","./add"],["routerLinkActive",""]],[[1,"target",0],[8,"href",4],[1,"aria-current",0],[1,"aria-disabled",0],[1,"tabIndex",0],[2,"mat-tab-disabled",null],[2,"mat-tab-label-active",null]],[[null,"click"]],(function(n,e,t){var a=!0;return"click"===e&&(a=!1!==o.Ob(n,12).onClick(t.button,t.ctrlKey,t.metaKey,t.shiftKey)&&a),a}),null,null)),o.yb(12,671744,[[5,4]],0,f.r,[f.o,f.a,h.j],{routerLink:[0,"routerLink"]},null),o.yb(13,1720320,[["rla2",4]],2,f.q,[f.o,o.l,o.F,[2,f.p],[2,f.r]],{routerLinkActive:[0,"routerLinkActive"]},null),o.Ub(603979776,4,{links:1}),o.Ub(603979776,5,{linksWithHrefs:1}),o.yb(16,147456,[[1,4]],0,r.j,[r.k,o.l,o.A,u.a,[2,l.i],[8,null],c.h,[2,s.a]],{active:[0,"active"]},null),(n()(),o.Yb(-1,null,[" Add Coupon "])),(n()(),o.zb(18,0,null,0,4,"span",[["class","company-edit-coupon-link"],["routerLink","./edit"],["routerLinkActive",""]],null,[[null,"click"]],(function(n,e,t){var a=!0;return"click"===e&&(a=!1!==o.Ob(n,19).onClick()&&a),a}),null,null)),o.yb(19,16384,[[6,4]],0,f.p,[f.o,f.a,[8,null],o.F,o.l],{routerLink:[0,"routerLink"]},null),o.yb(20,1720320,[["rla4",4]],2,f.q,[f.o,o.l,o.F,[2,f.p],[2,f.r]],{routerLinkActive:[0,"routerLinkActive"]},null),o.Ub(603979776,6,{links:1}),o.Ub(603979776,7,{linksWithHrefs:1}),(n()(),o.ib(16777216,null,0,1,null,m)),o.yb(24,16384,null,0,h.m,[o.Q,o.N],{ngIf:[0,"ngIf"]},null),(n()(),o.zb(25,0,null,null,2,"div",[["class","company-manager-content"]],null,null,null,null,null)),(n()(),o.zb(26,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),o.yb(27,212992,null,0,f.t,[f.b,o.Q,o.j,[8,null],o.h],null,null)],(function(n,e){n(e,2,0,"primary"),n(e,5,0,"./all"),n(e,6,0,""),n(e,9,0,o.Ob(e,6).isActive),n(e,12,0,"./add"),n(e,13,0,""),n(e,16,0,o.Ob(e,13).isActive),n(e,19,0,"./edit"),n(e,20,0,""),n(e,24,0,o.Ob(e,20).isActive),n(e,27,0)}),(function(n,e){n(e,1,0,o.Ob(e,2)._showPaginationControls,"rtl"==o.Ob(e,2)._getLayoutDirection(),"warn"!==o.Ob(e,2).color&&"accent"!==o.Ob(e,2).color,"accent"===o.Ob(e,2).color,"warn"===o.Ob(e,2).color),n(e,4,0,o.Ob(e,5).target,o.Ob(e,5).href,o.Ob(e,9).active?"page":null,o.Ob(e,9).disabled,o.Ob(e,9).tabIndex,o.Ob(e,9).disabled,o.Ob(e,9).active),n(e,11,0,o.Ob(e,12).target,o.Ob(e,12).href,o.Ob(e,16).active?"page":null,o.Ob(e,16).disabled,o.Ob(e,16).tabIndex,o.Ob(e,16).disabled,o.Ob(e,16).active)}))}var C,w=o.vb("app-coupon-manager",v,(function(n){return o.bc(0,[(n()(),o.zb(0,0,null,null,1,"app-coupon-manager",[],null,null,null,k,y)),o.yb(1,114688,null,0,v,[g.a],null,null)],(function(n,e){n(e,1,0)}),null)}),{},{},[]),O=t("9b/N"),j=t("EY2u"),A=t("JIr8"),I=t("Fcnm"),M=((C=function(){function n(e){_classCallCheck(this,n),this.couponManager=e}return _createClass(n,[{key:"resolve",value:function(n,e){return this.couponManager.getAllCompanies().pipe(Object(A.a)((function(n){return j.a})))}}]),n}()).\u0275prov=o.cc({factory:function(){return new C(o.dc(I.a))},token:C,providedIn:"root"}),C),P=function(){return Promise.all([t.e(3),t.e(27)]).then(t.bind(null,"7oKm")).then((function(n){return n.AllCouponsModuleNgFactory}))},_=function(){return Promise.all([t.e(1),t.e(4),t.e(28)]).then(t.bind(null,"YFT4")).then((function(n){return n.EditCouponModuleNgFactory}))},U=function(){return Promise.all([t.e(1),t.e(4),t.e(26)]).then(t.bind(null,"ljlp")).then((function(n){return n.AddCouponModuleNgFactory}))},L=function n(){_classCallCheck(this,n)},x=t("1z/I");t.d(e,"CouponManagerModuleNgFactory",(function(){return z}));var z=o.wb(a,[],(function(n){return o.Lb([o.Mb(512,o.j,o.ab,[[8,[i.a,w]],[3,o.j],o.y]),o.Mb(4608,h.o,h.n,[o.v]),o.Mb(4608,O.c,O.c,[]),o.Mb(1073742336,h.c,h.c,[]),o.Mb(1073742336,f.s,f.s,[[2,f.x],[2,f.o]]),o.Mb(1073742336,L,L,[]),o.Mb(1073742336,d.a,d.a,[]),o.Mb(1073742336,l.j,l.j,[c.j,[2,l.c],[2,h.d]]),o.Mb(1073742336,x.g,x.g,[]),o.Mb(1073742336,u.b,u.b,[]),o.Mb(1073742336,l.t,l.t,[]),o.Mb(1073742336,O.d,O.d,[]),o.Mb(1073742336,c.a,c.a,[c.j]),o.Mb(1073742336,r.l,r.l,[]),o.Mb(1073742336,a,a,[]),o.Mb(1024,f.m,(function(){return[[{path:"",component:v,resolve:{companies:M},children:[{path:"",pathMatch:"full",redirectTo:"all"},{path:"all",loadChildren:P},{path:"edit",loadChildren:_},{path:"add",loadChildren:U}]}]]}),[])])}))},Fcnm:function(n,e,t){"use strict";t.d(e,"a",(function(){return O}));var o=t("nYR2"),a=t("5+tZ"),i=t("lJxs"),r=t("vkgz"),u=t("pLZG"),l=t("SxV6"),c=t("UbeY"),s=t("HDdC"),p=t("z6cu"),d=t("LRne"),b=t("1aa5"),f=t("LYSW"),h=t("IheW"),v=t("8Y7J"),g=t("Nf/F"),y=t("CQUn"),m=t("4zr2"),k=t("iELJ"),C=t("yW4/"),w=t("zHaW"),O=function(){var n=function(){function n(e,t,o,a,i,r){_classCallCheck(this,n),this.sessionService=e,this.adminService=t,this.companyService=o,this.dialog=a,this.progressBar=i,this.snackBar=r,this.coupons=null,this.lastAddedCoupon=null,this._uploadProgressPercentage=void 0}return _createClass(n,[{key:"deleteCoupon",value:function(n){var e=this;return new s.a((function(t){e.openDeleteDialog().afterClosed().subscribe((function(a){a?e.service.subscribe((function(a){e.progressBar.status=!0,a.deleteCoupon(n.id).pipe(Object(o.a)((function(){return e.progressBar.status=!1}))).subscribe((function(n){e.snackBar.open("The coupon has been deleted successfully"),t.next(),t.complete()}))}),(function(n){return t.error(n)})):t.complete()}))}))}},{key:"addCoupon",value:function(n,e){var t=this;return new s.a((function(a){t.service.subscribe((function(i){t.progressBar.status=!0;var r=n.imagePreview;i.addCoupon(n).pipe(Object(o.a)((function(){t.progressBar.status=!1}))).subscribe((function(n){n.imagePreview=r,t.lastAddedCoupon=n,a.next(n),t.snackBar.open("The coupon has been added successfully"),e?t._uploadImage(t.lastAddedCoupon,e,a):a.complete()}),a.error)}),a.error)}))}},{key:"updateCoupon",value:function(n){var e=this;return new s.a((function(t){e.service.subscribe((function(a){e.progressBar.status=!0,a.updateCoupon(n).pipe(Object(o.a)((function(){e.progressBar.status=!1}))).subscribe((function(n){e.snackBar.open("The coupon has been updated successfully"),t.next(n),t.complete()}))}),t.error)}))}},{key:"getAllCoupons",value:function(){var n=this;return this.service.pipe(Object(a.a)((function(e){return e.getCoupons().pipe(Object(i.a)((function(e){return n.coupons=e})))})))}},{key:"getAllCategories",value:function(){return this.service.pipe(Object(a.a)((function(n){return n.getAllCategories()})))}},{key:"getCoupon",value:function(n){if(!n||isNaN(n))return this.snackBar.open("Invalid coupon id"),Object(p.a)(null);var e=this.lastAddedCoupon;return e&&e.id===n?(this.lastAddedCoupon=null,Object(d.a)(e)):this.service.pipe(Object(a.a)((function(e){return e.getCoupon(n)})))}},{key:"uploadImage",value:function(n,e,t){var o=this,l=n.imageUrl;return n.imageUrl=null,this.service.pipe(Object(a.a)((function(a){return a.uploadCouponImage(n.id,e).pipe(Object(r.a)((function(n){n.type===h.f.UploadProgress&&(o._uploadProgressPercentage=Math.round(100*n.loaded/n.total))})),Object(u.a)((function(n){return n.type===h.f.Response})),Object(i.a)((function(n){return new b.a(n.body)})),Object(r.a)((function(n){o._uploadProgressPercentage=void 0,t||o.snackBar.open("The image has been uploaded successfully")}),(function(e){return n.imageUrl=l})))})))}},{key:"deleteImage",value:function(n){var e=this;return this.service.pipe(Object(a.a)((function(e){return e.deleteCouponImage(n)}))).pipe(Object(r.a)((function(n){return e.snackBar.open("The image has been deleted successfully")})))}},{key:"getAllCompanies",value:function(){var n=this;return this.sessionService.userType$().pipe(Object(l.a)(),Object(a.a)((function(e){return e===c.a.ADMIN?n.adminService.getAllCompanies():e===c.a.COMPANY?n.companyService.getCompany().pipe(Object(i.a)((function(n){return[n]}))):Object(p.a)("Unable to fetch companies, invalid user type: ".concat(e))})))}},{key:"getWarningDialog",value:function(){return this.dialog.open(f.a,{data:{title:"Confirm discard changes",body:"Do you wish to discard changes?",action:"Discard"}}).afterClosed()}},{key:"_uploadImage",value:function(n,e,t){this.uploadImage(n,e,!0).subscribe((function(e){n.imageUrl=e.imageUrl,n.imagePreview=null,t.next(n),t.complete()}),(function(n){return t.error(n)}))}},{key:"openDeleteDialog",value:function(){return this.dialog.open(f.a,{data:{title:"Confirm coupon deletion",body:"Are you sure you want to delete this coupon?",action:"Delete"}})}},{key:"uploadProgressPercentage",get:function(){return this._uploadProgressPercentage}},{key:"service",get:function(){var n=this;return this.sessionService.userType$().pipe(Object(l.a)(),Object(a.a)((function(e){return e===c.a.ADMIN?Object(d.a)(n.adminService):e===c.a.COMPANY?Object(d.a)(n.companyService):(n.snackBar.open("Unable to fulfill request: invalid user type ".concat(e)),Object(p.a)(null))})))}}]),n}();return n.\u0275prov=v.cc({factory:function(){return new n(v.dc(g.a),v.dc(y.a),v.dc(m.a),v.dc(k.e),v.dc(C.a),v.dc(w.c))},token:n,providedIn:"root"}),n}()},jFTd:function(n,e,t){"use strict";t.d(e,"a",(function(){return l}));var o=t("lJxs"),a=t("1aa5"),i=t("8Y7J"),r=t("IheW"),u=t("rnfj"),l=function(){var n=function(){function n(e,t){_classCallCheck(this,n),this.client=e,this.endpoint=t}return _createClass(n,[{key:"getCoupon",value:function(n){if(!n||isNaN(n))throw new Error("Unable to get coupon without Id");return this.client.get("".concat(this.endpoint.url,"public/coupons/").concat(n))}},{key:"getAllCoupons",value:function(){return this.client.get("".concat(this.endpoint.url,"public/coupons/")).pipe(Object(o.a)((function(n){return n.map((function(n){return new a.a(n)}))})))}},{key:"getCouponsByCategory",value:function(n){if(!n||isNaN(n))throw new Error("Unable to get coupons by category without category Id");return this.client.get("".concat(this.endpoint.url,"public/coupons/categories/").concat(n)).pipe(Object(o.a)((function(n){return n.map((function(n){return new a.a(n)}))})))}},{key:"getCouponsByCompany",value:function(n){if(!n||isNaN(n))throw new Error("Unable to get coupons by company without company Id");return this.client.get("".concat(this.endpoint.url,"public/coupons/companies/").concat(n)).pipe(Object(o.a)((function(n){return n.map((function(n){return new a.a(n)}))})))}}]),n}();return n.\u0275prov=i.cc({factory:function(){return new n(i.dc(r.c),i.dc(u.a))},token:n,providedIn:"root"}),n}()},pLIu:function(n,e,t){"use strict";t.d(e,"a",(function(){return l}));var o=t("JIr8"),a=t("EY2u"),i=t("8Y7J"),r=t("RA2U"),u=t("iInd"),l=function(){var n=function(){function n(e,t){_classCallCheck(this,n),this.accountService=e,this.router=t}return _createClass(n,[{key:"resolve",value:function(n,e){var t=this;return this.accountService.getAccount().pipe(Object(o.a)((function(n){return t.router.navigate(["/.."]),a.a})))}}]),n}();return n.\u0275prov=i.cc({factory:function(){return new n(i.dc(r.a),i.dc(u.o))},token:n,providedIn:"root"}),n}()}}]);