(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"4zr2":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n("3WY7"),a=n("lJxs"),i=n("1aa5"),r=n("ODr4"),l=n("8Y7J"),u=n("IheW"),c=n("rnfj");let s=(()=>{class e{constructor(e,t){this.client=e,this.endpoint=t}getCompany(){return this.client.get(`${this.endpoint.url}company/`,{withCredentials:!0}).pipe(Object(a.a)(e=>new o.a(e)))}getCoupons(){return this.client.get(`${this.endpoint.url}company/coupons/`,{withCredentials:!0}).pipe(Object(a.a)(e=>e.map(e=>new i.a(e))))}deleteCoupon(e){if(!e)throw new Error("Unable to delete coupon without id");return this.client.delete(`${this.endpoint.url}company/coupons/${e}`,{withCredentials:!0})}getCoupon(e){if(!e)throw new Error("Unable to get coupon without id");return this.client.get(`${this.endpoint.url}company/coupons/${e}`,{withCredentials:!0}).pipe(Object(a.a)(e=>new i.a(e)))}getAllCategories(){return this.client.get(`${this.endpoint.url}company/coupons/categories`,{withCredentials:!0}).pipe(Object(a.a)(e=>e.map(e=>new r.a(e))))}addCoupon(e){if(!e)throw new Error("Unable to add coupon without coupon");return this.client.post(`${this.endpoint.url}company/coupons/`,e.serialize(),{withCredentials:!0}).pipe(Object(a.a)(e=>new i.a(e)))}updateCoupon(e){if(!e)throw new Error("Unable to add coupon without coupon");return this.client.put(`${this.endpoint.url}company/coupons/`,e.serialize(),{withCredentials:!0}).pipe(Object(a.a)(e=>new i.a(e)))}uploadCouponImage(e,t){if(!t)throw new Error("Unable to upload coupon image without image");const n=new FormData;return n.append("image",t),this.client.post(`${this.endpoint.url}company/coupons/${e}/images`,n,{withCredentials:!0,reportProgress:!0,observe:"events"})}deleteCouponImage(e){if(!e)throw new Error("Unable to delete coupon image without id");return this.client.delete(`${this.endpoint.url}company/coupons/${e}/images`,{withCredentials:!0}).pipe(Object(a.a)(e=>new i.a(e)))}updateCompany(e){if(!e)throw new Error("Unable to update company without company");return this.client.put(`${this.endpoint.url}company/`,e.serialize,{withCredentials:!0}).pipe(Object(a.a)(e=>new o.a(e)))}uploadCompanyLogo(e){if(!e)throw new Error("Unable to upload company logo without image");const t=new FormData;return t.append("image",e),this.client.post(`${this.endpoint.url}company/logo/`,t,{withCredentials:!0,reportProgress:!0,observe:"events"})}deleteCompanyLogo(){return this.client.delete(`${this.endpoint.url}company/logo/`,{withCredentials:!0}).pipe(Object(a.a)(e=>new o.a(e)))}}return e.\u0275prov=l.cc({factory:function(){return new e(l.dc(u.c),l.dc(c.a))},token:e,providedIn:"root"}),e})()},"B/JR":function(e,t,n){"use strict";n.r(t);var o=n("8Y7J");class a{}var i=n("pMnS"),r=n("M9ds"),l=n("SCoL"),u=n("UhP/"),c=n("YEUz"),s=n("omvX"),p=n("Pwwu"),d=n("9gLZ"),b=n("7KAL"),h=n("iInd"),g=n("SVse");class m{constructor(e){this.titleService=e}ngOnInit(){this.titleService.append("Coupon Manager")}}var v=n("Trmh"),y=o.xb({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;flex:1 0 auto}.company-manager-container[_ngcontent-%COMP%]{min-height:100%;box-sizing:border-box;width:100%;flex:1 0 auto;display:flex;flex-direction:column}.company-manager-content[_ngcontent-%COMP%]{flex:1 0 auto;min-height:100%;width:100%;display:flex}.company-nav-bar[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;z-index:1;background-color:#fff}.company-edit-coupon-link[_ngcontent-%COMP%]{display:none}"]],data:{}});function w(e){return o.bc(0,[(e()(),o.zb(0,0,null,null,2,"div",[["class","mat-tab-link mat-focus-indicator"],["mat-tab-link",""]],[[1,"aria-current",0],[1,"aria-disabled",0],[1,"tabIndex",0],[2,"mat-tab-disabled",null],[2,"mat-tab-label-active",null]],null,null,null,null)),o.yb(1,147456,[[1,4]],0,r.j,[r.k,o.l,o.A,l.a,[2,u.i],[8,null],c.h,[2,s.a]],{active:[0,"active"]},null),(e()(),o.Yb(-1,null,[" Edit Coupon "]))],(function(e,t){e(t,1,0,o.Ob(t.parent,20).isActive)}),(function(e,t){e(t,0,0,o.Ob(t,1).active?"page":null,o.Ob(t,1).disabled,o.Ob(t,1).tabIndex,o.Ob(t,1).disabled,o.Ob(t,1).active)}))}function f(e){return o.bc(0,[(e()(),o.zb(0,0,null,null,27,"div",[["class","company-manager-container"]],null,null,null,null,null)),(e()(),o.zb(1,0,null,null,23,"nav",[["class","company-nav-bar mat-tab-nav-bar mat-tab-header"],["color","primary"],["mat-tab-nav-bar",""]],[[2,"mat-tab-header-pagination-controls-enabled",null],[2,"mat-tab-header-rtl",null],[2,"mat-primary",null],[2,"mat-accent",null],[2,"mat-warn",null]],null,null,p.e,p.c)),o.yb(2,7520256,null,1,r.k,[o.l,[2,d.b],o.A,o.h,b.e,[2,l.a],[2,s.a]],{color:[0,"color"]},null),o.Ub(603979776,1,{_items:1}),(e()(),o.zb(4,0,null,0,6,"a",[["class","mat-tab-link mat-focus-indicator"],["mat-tab-link",""],["routerLink","./all"],["routerLinkActive",""]],[[1,"target",0],[8,"href",4],[1,"aria-current",0],[1,"aria-disabled",0],[1,"tabIndex",0],[2,"mat-tab-disabled",null],[2,"mat-tab-label-active",null]],[[null,"click"]],(function(e,t,n){var a=!0;return"click"===t&&(a=!1!==o.Ob(e,5).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&a),a}),null,null)),o.yb(5,671744,[[3,4]],0,h.r,[h.o,h.a,g.j],{routerLink:[0,"routerLink"]},null),o.yb(6,1720320,[["rla1",4]],2,h.q,[h.o,o.l,o.F,[2,h.p],[2,h.r]],{routerLinkActive:[0,"routerLinkActive"]},null),o.Ub(603979776,2,{links:1}),o.Ub(603979776,3,{linksWithHrefs:1}),o.yb(9,147456,[[1,4]],0,r.j,[r.k,o.l,o.A,l.a,[2,u.i],[8,null],c.h,[2,s.a]],{active:[0,"active"]},null),(e()(),o.Yb(-1,null,[" All Coupons "])),(e()(),o.zb(11,0,null,0,6,"a",[["class","mat-tab-link mat-focus-indicator"],["mat-tab-link",""],["routerLink","./add"],["routerLinkActive",""]],[[1,"target",0],[8,"href",4],[1,"aria-current",0],[1,"aria-disabled",0],[1,"tabIndex",0],[2,"mat-tab-disabled",null],[2,"mat-tab-label-active",null]],[[null,"click"]],(function(e,t,n){var a=!0;return"click"===t&&(a=!1!==o.Ob(e,12).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&a),a}),null,null)),o.yb(12,671744,[[5,4]],0,h.r,[h.o,h.a,g.j],{routerLink:[0,"routerLink"]},null),o.yb(13,1720320,[["rla2",4]],2,h.q,[h.o,o.l,o.F,[2,h.p],[2,h.r]],{routerLinkActive:[0,"routerLinkActive"]},null),o.Ub(603979776,4,{links:1}),o.Ub(603979776,5,{linksWithHrefs:1}),o.yb(16,147456,[[1,4]],0,r.j,[r.k,o.l,o.A,l.a,[2,u.i],[8,null],c.h,[2,s.a]],{active:[0,"active"]},null),(e()(),o.Yb(-1,null,[" Add Coupon "])),(e()(),o.zb(18,0,null,0,4,"span",[["class","company-edit-coupon-link"],["routerLink","./edit"],["routerLinkActive",""]],null,[[null,"click"]],(function(e,t,n){var a=!0;return"click"===t&&(a=!1!==o.Ob(e,19).onClick()&&a),a}),null,null)),o.yb(19,16384,[[6,4]],0,h.p,[h.o,h.a,[8,null],o.F,o.l],{routerLink:[0,"routerLink"]},null),o.yb(20,1720320,[["rla4",4]],2,h.q,[h.o,o.l,o.F,[2,h.p],[2,h.r]],{routerLinkActive:[0,"routerLinkActive"]},null),o.Ub(603979776,6,{links:1}),o.Ub(603979776,7,{linksWithHrefs:1}),(e()(),o.ib(16777216,null,0,1,null,w)),o.yb(24,16384,null,0,g.m,[o.Q,o.N],{ngIf:[0,"ngIf"]},null),(e()(),o.zb(25,0,null,null,2,"div",[["class","company-manager-content"]],null,null,null,null,null)),(e()(),o.zb(26,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),o.yb(27,212992,null,0,h.t,[h.b,o.Q,o.j,[8,null],o.h],null,null)],(function(e,t){e(t,2,0,"primary"),e(t,5,0,"./all"),e(t,6,0,""),e(t,9,0,o.Ob(t,6).isActive),e(t,12,0,"./add"),e(t,13,0,""),e(t,16,0,o.Ob(t,13).isActive),e(t,19,0,"./edit"),e(t,20,0,""),e(t,24,0,o.Ob(t,20).isActive),e(t,27,0)}),(function(e,t){e(t,1,0,o.Ob(t,2)._showPaginationControls,"rtl"==o.Ob(t,2)._getLayoutDirection(),"warn"!==o.Ob(t,2).color&&"accent"!==o.Ob(t,2).color,"accent"===o.Ob(t,2).color,"warn"===o.Ob(t,2).color),e(t,4,0,o.Ob(t,5).target,o.Ob(t,5).href,o.Ob(t,9).active?"page":null,o.Ob(t,9).disabled,o.Ob(t,9).tabIndex,o.Ob(t,9).disabled,o.Ob(t,9).active),e(t,11,0,o.Ob(t,12).target,o.Ob(t,12).href,o.Ob(t,16).active?"page":null,o.Ob(t,16).disabled,o.Ob(t,16).tabIndex,o.Ob(t,16).disabled,o.Ob(t,16).active)}))}function C(e){return o.bc(0,[(e()(),o.zb(0,0,null,null,1,"app-coupon-manager",[],null,null,null,f,y)),o.yb(1,114688,null,0,m,[v.a],null,null)],(function(e,t){e(t,1,0)}),null)}var O=o.vb("app-coupon-manager",m,C,{},{},[]),k=n("9b/N"),j=n("EY2u"),A=n("JIr8"),I=n("Fcnm");let M=(()=>{class e{constructor(e){this.couponManager=e}resolve(e,t){return this.couponManager.getAllCompanies().pipe(Object(A.a)(e=>j.a))}}return e.\u0275prov=o.cc({factory:function(){return new e(o.dc(I.a))},token:e,providedIn:"root"}),e})();const U=()=>Promise.all([n.e(3),n.e(27)]).then(n.bind(null,"7oKm")).then(e=>e.AllCouponsModuleNgFactory),L=()=>Promise.all([n.e(1),n.e(4),n.e(28)]).then(n.bind(null,"YFT4")).then(e=>e.EditCouponModuleNgFactory),P=()=>Promise.all([n.e(1),n.e(4),n.e(26)]).then(n.bind(null,"ljlp")).then(e=>e.AddCouponModuleNgFactory);class ${}var x=n("1z/I");n.d(t,"CouponManagerModuleNgFactory",(function(){return z}));var z=o.wb(a,[],(function(e){return o.Lb([o.Mb(512,o.j,o.ab,[[8,[i.a,O]],[3,o.j],o.y]),o.Mb(4608,g.o,g.n,[o.v]),o.Mb(4608,k.c,k.c,[]),o.Mb(1073742336,g.c,g.c,[]),o.Mb(1073742336,h.s,h.s,[[2,h.x],[2,h.o]]),o.Mb(1073742336,$,$,[]),o.Mb(1073742336,d.a,d.a,[]),o.Mb(1073742336,u.j,u.j,[c.j,[2,u.c],[2,g.d]]),o.Mb(1073742336,x.g,x.g,[]),o.Mb(1073742336,l.b,l.b,[]),o.Mb(1073742336,u.t,u.t,[]),o.Mb(1073742336,k.d,k.d,[]),o.Mb(1073742336,c.a,c.a,[c.j]),o.Mb(1073742336,r.l,r.l,[]),o.Mb(1073742336,a,a,[]),o.Mb(1024,h.m,(function(){return[[{path:"",component:m,resolve:{companies:M},children:[{path:"",pathMatch:"full",redirectTo:"all"},{path:"all",loadChildren:U},{path:"edit",loadChildren:L},{path:"add",loadChildren:P}]}]]}),[])])}))},Fcnm:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var o=n("nYR2"),a=n("5+tZ"),i=n("lJxs"),r=n("vkgz"),l=n("pLZG"),u=n("SxV6"),c=n("UbeY"),s=n("HDdC"),p=n("z6cu"),d=n("LRne"),b=n("1aa5"),h=n("LYSW"),g=n("IheW"),m=n("8Y7J"),v=n("Nf/F"),y=n("CQUn"),w=n("4zr2"),f=n("iELJ"),C=n("yW4/"),O=n("zHaW");let k=(()=>{class e{constructor(e,t,n,o,a,i){this.sessionService=e,this.adminService=t,this.companyService=n,this.dialog=o,this.progressBar=a,this.snackBar=i,this.coupons=null,this.lastAddedCoupon=null,this._uploadProgressPercentage=void 0}deleteCoupon(e){return new s.a(t=>{this.openDeleteDialog().afterClosed().subscribe(n=>{n?this.service.subscribe(n=>{this.progressBar.status=!0,n.deleteCoupon(e.id).pipe(Object(o.a)(()=>this.progressBar.status=!1)).subscribe(e=>{this.snackBar.open("The coupon has been deleted successfully"),t.next(),t.complete()})},e=>t.error(e)):t.complete()})})}addCoupon(e,t){return new s.a(n=>{this.service.subscribe(a=>{this.progressBar.status=!0;const i=e.imagePreview;a.addCoupon(e).pipe(Object(o.a)(()=>{this.progressBar.status=!1})).subscribe(e=>{e.imagePreview=i,this.lastAddedCoupon=e,n.next(e),this.snackBar.open("The coupon has been added successfully"),t?this._uploadImage(this.lastAddedCoupon,t,n):n.complete()},n.error)},n.error)})}updateCoupon(e){return new s.a(t=>{this.service.subscribe(n=>{this.progressBar.status=!0,n.updateCoupon(e).pipe(Object(o.a)(()=>{this.progressBar.status=!1})).subscribe(e=>{this.snackBar.open("The coupon has been updated successfully"),t.next(e),t.complete()})},t.error)})}getAllCoupons(){return this.service.pipe(Object(a.a)(e=>e.getCoupons().pipe(Object(i.a)(e=>this.coupons=e))))}getAllCategories(){return this.service.pipe(Object(a.a)(e=>e.getAllCategories()))}getCoupon(e){if(!e||isNaN(e))return this.snackBar.open("Invalid coupon id"),Object(p.a)(null);const t=this.lastAddedCoupon;return t&&t.id===e?(this.lastAddedCoupon=null,Object(d.a)(t)):this.service.pipe(Object(a.a)(t=>t.getCoupon(e)))}uploadImage(e,t,n){const o=e.imageUrl;return e.imageUrl=null,this.service.pipe(Object(a.a)(a=>a.uploadCouponImage(e.id,t).pipe(Object(r.a)(e=>{e.type===g.f.UploadProgress&&(this._uploadProgressPercentage=Math.round(100*e.loaded/e.total))}),Object(l.a)(e=>e.type===g.f.Response),Object(i.a)(e=>new b.a(e.body)),Object(r.a)(e=>{this._uploadProgressPercentage=void 0,n||this.snackBar.open("The image has been uploaded successfully")},t=>e.imageUrl=o))))}deleteImage(e){return this.service.pipe(Object(a.a)(t=>t.deleteCouponImage(e))).pipe(Object(r.a)(e=>this.snackBar.open("The image has been deleted successfully")))}get uploadProgressPercentage(){return this._uploadProgressPercentage}getAllCompanies(){return this.sessionService.userType$().pipe(Object(u.a)(),Object(a.a)(e=>e===c.a.ADMIN?this.adminService.getAllCompanies():e===c.a.COMPANY?this.companyService.getCompany().pipe(Object(i.a)(e=>[e])):Object(p.a)(`Unable to fetch companies, invalid user type: ${e}`)))}getWarningDialog(){return this.dialog.open(h.a,{data:{title:"Confirm discard changes",body:"Do you wish to discard changes?",action:"Discard"}}).afterClosed()}_uploadImage(e,t,n){this.uploadImage(e,t,!0).subscribe(t=>{e.imageUrl=t.imageUrl,e.imagePreview=null,n.next(e),n.complete()},e=>n.error(e))}openDeleteDialog(){return this.dialog.open(h.a,{data:{title:"Confirm coupon deletion",body:"Are you sure you want to delete this coupon?",action:"Delete"}})}get service(){return this.sessionService.userType$().pipe(Object(u.a)(),Object(a.a)(e=>e===c.a.ADMIN?Object(d.a)(this.adminService):e===c.a.COMPANY?Object(d.a)(this.companyService):(this.snackBar.open(`Unable to fulfill request: invalid user type ${e}`),Object(p.a)(null))))}}return e.\u0275prov=m.cc({factory:function(){return new e(m.dc(v.a),m.dc(y.a),m.dc(w.a),m.dc(f.e),m.dc(C.a),m.dc(O.c))},token:e,providedIn:"root"}),e})()},jFTd:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o=n("lJxs"),a=n("1aa5"),i=n("8Y7J"),r=n("IheW"),l=n("rnfj");let u=(()=>{class e{constructor(e,t){this.client=e,this.endpoint=t}getCoupon(e){if(!e||isNaN(e))throw new Error("Unable to get coupon without Id");return this.client.get(`${this.endpoint.url}public/coupons/${e}`)}getAllCoupons(){return this.client.get(`${this.endpoint.url}public/coupons/`).pipe(Object(o.a)(e=>e.map(e=>new a.a(e))))}getCouponsByCategory(e){if(!e||isNaN(e))throw new Error("Unable to get coupons by category without category Id");return this.client.get(`${this.endpoint.url}public/coupons/categories/${e}`).pipe(Object(o.a)(e=>e.map(e=>new a.a(e))))}getCouponsByCompany(e){if(!e||isNaN(e))throw new Error("Unable to get coupons by company without company Id");return this.client.get(`${this.endpoint.url}public/coupons/companies/${e}`).pipe(Object(o.a)(e=>e.map(e=>new a.a(e))))}}return e.\u0275prov=i.cc({factory:function(){return new e(i.dc(r.c),i.dc(l.a))},token:e,providedIn:"root"}),e})()},pLIu:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o=n("JIr8"),a=n("EY2u"),i=n("8Y7J"),r=n("RA2U"),l=n("iInd");let u=(()=>{class e{constructor(e,t){this.accountService=e,this.router=t}resolve(e,t){return this.accountService.getAccount().pipe(Object(o.a)(e=>(this.router.navigate(["/.."]),a.a)))}}return e.\u0275prov=i.cc({factory:function(){return new e(i.dc(r.a),i.dc(l.o))},token:e,providedIn:"root"}),e})()}}]);